/*
 * Copyright (c) 2015 IBM Corporation.
 *  
 *
 * @author : m schett
 * @date   : 08/02/2015
 */


(

Assert[ State[Mgu[( PairCons[ "#X",  %term⟦ A ⟧]; )],0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X ⟧ , %term⟦ A ⟧]]
      ]; 

Assert[ State[Mgu[( PairCons[ "#X",  %term⟦ F[A,B] ⟧]; )],0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X ⟧ , %term⟦ F[A,B] ⟧]]
      ];

Assert[ State[Mgu[( PairCons[ "#X",  %term⟦ x.F[x] ⟧]; )],0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X[x] ⟧ ,%term⟦ F[x] ⟧]]
      ]; 

Assert[ State[Mgu[( PairCons[ "#X",  %term⟦ x y.F[x] ⟧]; )],0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X[x,y] ⟧ ,%term⟦ F[x] ⟧]]
      ]; 

Assert[ State[Mgu[( PairCons[ "#X",  %term⟦ x y .F[y,x] ⟧]; )],0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X[x,y] ⟧ , %term⟦ F[y,x] ⟧]]
      ]; 

Assert[ State[FAIL,0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ x y.#X[x,y] ⟧ , %term⟦ Plus[0,0] ⟧]]
      ]; 

Assert[ State[FAIL,0],
        Unify[State[Mgu[()],0], PairCons[ %term ⟦ #X[x,y] ⟧ , %term⟦ x.Plus[0,0] ⟧]]
      ]; 

// bound terms

Assert[ Mgu[ (PairCons["#G", %term⟦ x.#0[x] ⟧]; PairCons["#F", %term⟦ x.#0[x] ⟧];) ],
        GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x. #F[x] ⟧ , %term⟦  x . #G[x]  ⟧]]]
       ];
 

Assert[ State[Mgu[( PairCons[ "#G",  %term⟦ y x . #0[x] ⟧];  PairCons[ "#F",  %term⟦ x . C[#0[x]] ⟧]; )], 1],
        Unify[State[Mgu[()],0], PairCons[ %term⟦ x y . #F[x] ⟧, %term⟦ x y. C[#G[y,x]] ⟧ ]]  ];


//alpha equv 
Assert[ Assoc[ "#G", GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x.#F[x] ⟧ , %term⟦  y .#G[y]  ⟧]]]],
        Assoc[ "#F", GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x.#F[x] ⟧ , %term⟦  y .#G[y]  ⟧]]]]
      ]; 

//alpha equv 2
Assert[ Assoc[ "#G", GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x.#F[x] ⟧ , %term⟦  y .#G[y]  ⟧]]]],
        Assoc[ "#F", GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x.#F[x] ⟧ , %term⟦  x .#G[x]  ⟧]]]]
      ]; 


/* Expected Error
Assert[ Error,
      GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ x y.#F[x,y] ⟧ , %term⟦  y x .#G[y,x]  ⟧]]]
    ]; 
*/

Assert[ Mgu[ (PairCons["#X", %term⟦ Zero ⟧]; PairCons["#G", %term⟦ y x.#0[x] ⟧]; PairCons["#F", %term⟦ x.#0[x] ⟧];) ],
        GetMgu[Unify[State[Mgu[()],0], PairCons[ %term ⟦ Div[x y. #F[x],#X] ⟧ , %term⟦  Div[x y. #G[y,x], Zero]  ⟧]]]
       ];




// renaming 
/*
Assert[ FAIL, // here we do not have distinct meta variables!
       Unify[ State[Mgu[()],0], PairCons[%term⟦ F[#X,#Y] ⟧, %term⟦ F[#Y,#X] ⟧] ]
      ]; 

*/
 
)