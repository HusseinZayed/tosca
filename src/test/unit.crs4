/*
 * Copyright (c) 2016 IBM Corporation.
 * 
 * Unit Testing Framework
 *
 */
 
import Std::Core
import Std::String
import Std::List

enum Test | TestCase(Boolean)
          | TestGroup( List<Test> ) 
          | TestInclude(String)
          
/* Assertion functions */
func Assert<a>(eager String, eager a, eager a) -> Boolean
rule Assert(#msg, #expected, #actual) → If( Equal(#expected, #actual), TRUE, Error(#msg) )

/* Main Driver */
func RunTest(Test) -> Boolean

rule RunTest(TestCase(#test))
→ Eval(#test)

rule RunTest(TestGroup(#tests))
→ FoldlP( [x y] -> And(y, RunTest(x)), TRUE, #tests )

rule RunTest(TestInclude(#file))
→ RunTest( ParseTerm(#file) )
